---
project_name: parcel-flow
user_name: Antoine
date: 2026-01-19T13:23:43.627Z
sections_completed: []
---

# Project Context: Parcel-Flow

> **AI Agent Directive:** This file contains critical implementation rules, patterns, and conventions for the Parcel-Flow project. You MUST follow these rules to ensure consistency and quality. Read this file before implementing any code.

## 1. Technology Stack

- **Backend:** Java 21 (LTS), Spring Boot 3.3, Spring AI 1.1.x
- **Frontend:** React Native (Expo SDK 52), TypeScript 5+, React Native Paper 5.x
- **Database:** PostgreSQL 16
- **Testing:** JUnit 5, Cucumber JVM (Backend), Jest, React Native Testing Library (Frontend)
- **Architecture:** Strict Hexagonal Architecture (Ports & Adapters)
- **Infrastructure:** Docker, Testcontainers

## 2. Core Architectural Rules

### Hexagonal Purity (Critical)
- **Domain Isolation:** The `domain` package MUST NOT depend on any framework (Spring, JPA, etc.). It must remain pure Java.
- **No Reflection:** Reflection (`java.lang.reflect`) is strictly FORBIDDEN in the `domain` package to ensure explicitness.
- **Dependency Direction:** Infrastructure -> Application -> Domain. The Domain never depends on outer layers.

### Data Flow
- **Ingestion:** Gmail API -> Gemini (AI) -> Domain -> Persistence.
- **Consumption:** REST API (Aggregated Resources) -> Frontend (Zustand) -> UI (Paper).

## 3. Implementation Patterns

### Naming Conventions
- **Java:** `PascalCase` for classes, `camelCase` for methods/variables. Packages in `lowercase`.
- **TypeScript:** `PascalCase.tsx` for components, `camelCase.ts` for hooks/utils. No `I` prefix for interfaces.

### Error Handling
- **API:** RFC 7807 (Problem Details) format required for all error responses.
- **Frontend:** Handle loading, error, and empty states explicitly.

### Testing Strategy
- **Quality Standards (Critical):**
    - **No Story without Gherkin:** Any new User Story MUST include a corresponding `.feature` file (Cucumber) BEFORE implementation begins. This is a mandatory "Definition of Ready" (DoR) requirement.
    - **ATDD Workflow:** Official adoption of the `_bmad/bmm/workflows/testarch/atdd` workflow for all new features. Tests must be in "RED" phase (failing) before handoff to development.
    - **Nominal Flow Guard:** The frontend nominal flow test (`NominalFlow.test.tsx`) MUST pass in CI for every PR.
- **Backend:** ATDD First. Write `.feature` (Gherkin) -> Glue Code -> Domain Logic.
- **Frontend:** Component testing with React Native Testing Library. Focus on user-centric behavior.

## 4. Development Environment

- **Codespaces:** Project configured for GitHub Codespaces (`.devcontainer`).
- **Monorepo:** Strict separation of `/backend` and `/frontend` directories.

## 5. Development Process

- **Branching Policy:** Direct commits to the `main` branch are strictly FORBIDDEN. All development must happen in feature branches (e.g., `feat/`, `fix/`, `chore/`) and be merged via Pull Requests.

### Workflow Rules (Strict)

1.  **WIP Limit (Single Tasking):** A developer (agent or human) MUST NOT start a new User Story or Task until the current one is **merged** or explicitly put on hold. "Finish what you started."
2.  **Implementation Gate:** The `dev` agent performs implementation and local testing.
    - MUST ensure tests pass locally before committing.
    - MUST push changes and create a Pull Request (PR).
3.  **Code Review Gate:**
    - A PR MUST be reviewed by the `architect` agent (for standards compliance) AND the User.
    - The `dev` agent MUST address all review comments.
4.  **Merge Gate:** Only the **User** is authorized to merge the PR into `main`, after validating that the build is green and reviews are resolved.

---
_Generated by BMad Project Context Workflow_
